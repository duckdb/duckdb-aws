# name: test/sql/aws_sts_secret_profile.test
# description: test getting a secret via a profile that does sts
# group: [sql]

require aws

require httpfs

statement error
CREATE SECRET assume_role (
    TYPE S3,
    PROVIDER credential_chain,
    CHAIN 'config',
    PROFILE 'assume-role-arn-does-not-exist'
);
----
<REGEX>:.*Failed to load profile assume-role-arn-does-not-exist in credentials file.*

# can't create the credentials because we don't have a service to provide credentials via sts
statement error
CREATE SECRET assume_role (
    TYPE S3,
    PROVIDER credential_chain,
    PROFILE 'assume-role-arn'
);
----
<REGEX>:.*Invalid Input Error: Could not create AWS credentials with credential chain 'config' and profile 'assume-role-arn'.*
